import { I18nManager } from "react-native";
import { translateText as workerTranslate } from "@/utils/workerApi";

export const LANGUAGES = [
  {
    code: "en",
    name: "English",
    nativeName: "English",
    flag: "üá¨üáß",
    rtl: false,
  },
  {
    code: "es",
    name: "Spanish",
    nativeName: "Espa√±ol",
    flag: "üá™üá∏",
    rtl: false,
  },
  {
    code: "fr",
    name: "French",
    nativeName: "Fran√ßais",
    flag: "üá´üá∑",
    rtl: false,
  },
  { code: "de", name: "German", nativeName: "Deutsch", flag: "üá©üá™", rtl: false },
  {
    code: "it",
    name: "Italian",
    nativeName: "Italiano",
    flag: "üáÆüáπ",
    rtl: false,
  },
  {
    code: "pt",
    name: "Portuguese",
    nativeName: "Portugu√™s",
    flag: "üáµüáπ",
    rtl: false,
  },
  {
    code: "bg",
    name: "Bulgarian",
    nativeName: "–ë—ä–ª–≥–∞—Ä—Å–∫–∏",
    flag: "üáßüá¨",
    rtl: false,
  },
  {
    code: "tr",
    name: "Turkish",
    nativeName: "T√ºrk√ße",
    flag: "üáπüá∑",
    rtl: false,
  },
  {
    code: "ja",
    name: "Japanese",
    nativeName: "Êó•Êú¨Ë™û",
    flag: "üáØüáµ",
    rtl: false,
  },
  { code: "zh", name: "Chinese", nativeName: "‰∏≠Êñá", flag: "üá®üá≥", rtl: false },
  { code: "hi", name: "Hindi", nativeName: "‡§π‡§ø‡§®‡•ç‡§¶‡•Ä", flag: "üáÆüá≥", rtl: false },
  { code: "ar", name: "Arabic", nativeName: "ÿßŸÑÿπÿ±ÿ®Ÿäÿ©", flag: "üá∏üá¶", rtl: true },
];

export const DEFAULT_LANGUAGE = "en";

export function getLanguage(code) {
  return LANGUAGES.find((lang) => lang.code === code) || LANGUAGES[0];
}

export function isRTL(langCode) {
  const lang = getLanguage(langCode);
  return lang.rtl || false;
}

export function setRTL(isRTL) {
  if (I18nManager.isRTL !== isRTL) {
    I18nManager.forceRTL(isRTL);
    I18nManager.allowRTL(isRTL);
  }
}

export async function translateText(text, targetLang, sourceLang = "en") {
  try {
    // Use Worker API with automatic fallback to backend /api/translate
    const data = await workerTranslate(text, targetLang, sourceLang);
    return data.translatedText;
  } catch (error) {
    console.error("Translation error:", error);
    throw error;
  }
}

export const UI_TRANSLATIONS = {
  en: {
    loading: "Loading...",
    error: "Error",
    retry: "Retry",
    cancel: "Cancel",
    save: "Save",
    delete: "Delete",
    confirm: "Confirm",
    back: "Back",
    next: "Next",
    done: "Done",
    search: "Search",
    welcome: "Welcome to CryptoNews",
    subtitle: "Your personal crypto companion",
    selectLanguage: "Select Your Language",
    languageSubtitle: "Choose your preferred language",
    getStarted: "Get Started",
    tabHome: "Home",
    tabNews: "News",
    tabPortfolio: "Portfolio",
    tabMarket: "Market",
    tabRewards: "Rewards",
    tabSettings: "Settings",
    homeTitle: "Crypto News",
    homeSubtitle: "Stay updated with the latest",
    featuredArticles: "Featured Articles",
    readMore: "Read More",
    newsTitle: "Latest News",
    newsSubtitle: "Real-time crypto updates",
    loadMore: "Load More",
    noArticles: "No articles found",
    topStory: "TOP STORY",
    livePrices: "LIVE PRICES",
    allNews: "All News",
    cryptoNews: "Crypto News",
    market: "Market",
    analysis: "Analysis",
    portfolioTitle: "Portfolio",
    syncedAccount: "Synced to your account",
    storedLocally: "Stored locally on your device",
    totalValue: "Total Value",
    profitLoss: "Profit/Loss",
    returnPercent: "Return",
    yourAssets: "Your Assets",
    swipeToSeeMore: "Swipe to see more ‚Üí",
    noAssets: "No assets yet.\nStart building your portfolio!",
    addAsset: "Add Asset",
    trackingOnly: "Tracking only",
    value: "Value",
    searchCoin: "Search Coin",
    searchPlaceholder: "Search by name or ticker...",
    amount: "Amount (optional)",
    amountPlaceholder: "Leave empty to track without amount",
    buyPrice: "Buy Price (USD) (optional)",
    buyPricePlaceholder: "Leave empty to track without buy price",
    addToPortfolio: "Add to Portfolio",
    marketTitle: "Market",
    marketSubtitle: "Live crypto market data",
    topGainers: "üî• Top Gainers (24h)",
    topLosers: "üìâ Top Losers (24h)",
    topCoins: "üíé Top 20 by Market Cap",
    marketCap: "Mkt",
    volume: "Vol",
    change24h: "24h",
    price: "Price",
    rank: "#",
    lastUpdated: "Updated",
    pullToRefresh: "Pull to refresh",
    setPriceAlert: "Set Price Alert",
    priceAlerts: "Price Alerts",
    alertsNone: "No price alerts set",
    createAlert: "Create Alert",
    targetPrice: "Target Price",
    notifyWhen: "Notify when price",
    goesAbove: "Goes Above",
    goesBelow: "Goes Below",
    currentPrice: "Current",
    saveAlert: "Save Alert",
    deleteAlert: "Delete",
    alertSet: "Alert set for",
    coinAlerts: "Coin Alerts",
    showAll: "Show All",
    noAlertsForCoin: "No alerts for this coin yet.",
    addAlert: "Add Alert",
    addNewAlert: "Add New Alert",
    editAlert: "Edit Alert",
    notifyWhenGoesAbove: "Notify when price goes above",
    notifyWhenGoesBelow: "Notify when price goes below",
    saveChanges: "Save Changes",
    invalidAlert: "Invalid Alert",
    rewardsTitle: "Rewards",
    rewardsSubtitle: "Earn points daily",
    yourPoints: "Your Points",
    claimDaily: "Claim Daily Reward",
    claimed: "Claimed!",
    comeBackIn: "Come back in",
    hours: "hours",
    dontLoseSpuds: "Don't lose your Spuds!",
    createAccountSecure:
      "Create an account to secure your points and sync your portfolio.",
    tapPotatoEarn: "Tap the potato to earn 10 points",
    comeBackTomorrow: "Come back tomorrow for more Spuds!",
    howItWorks: "How it works",
    claim10Points: "Claim 10 Potato Points every 24 hours",
    buildStash: "Build your Spud stash by staying engaged",
    createAccountAt20: "Create an account at 20 points to secure your rewards",
    settingsTitle: "Settings",
    settingsSubtitle: "Customize your experience",
    language: "Language",
    account: "Account",
    signIn: "Sign In",
    signUp: "Sign Up",
    signOut: "Sign Out",
    signedInAs: "Signed in as",
    translateArticle: "Translate Article",
    translating: "Translating...",
    showOriginal: "View Original (EN)",
    translationError: "Translation failed. Please try again.",
    article: "Article",
    share: "Share",
    potatoPoints: "Potato Points",
  },
  es: {
    loading: "Cargando...",
    error: "Error",
    retry: "Reintentar",
    cancel: "Cancelar",
    save: "Guardar",
    delete: "Eliminar",
    confirm: "Confirmar",
    back: "Atr√°s",
    next: "Siguiente",
    done: "Hecho",
    search: "Buscar",
    welcome: "Bienvenido a CryptoNews",
    subtitle: "Tu compa√±ero cripto personal",
    selectLanguage: "Selecciona tu Idioma",
    languageSubtitle: "Elige tu idioma preferido",
    getStarted: "Comenzar",
    tabHome: "Inicio",
    tabNews: "Noticias",
    tabPortfolio: "Portafolio",
    tabMarket: "Mercado",
    tabRewards: "Recompensas",
    tabSettings: "Ajustes",
    homeTitle: "Noticias Cripto",
    homeSubtitle: "Mantente actualizado",
    featuredArticles: "Art√≠culos Destacados",
    readMore: "Leer M√°s",
    newsTitle: "√öltimas Noticias",
    newsSubtitle: "Actualizaciones en tiempo real",
    loadMore: "Cargar M√°s",
    noArticles: "No se encontraron art√≠culos",
    topStory: "DESTACADO",
    livePrices: "PRECIOS EN VIVO",
    allNews: "Todas las Noticias",
    cryptoNews: "Noticias Cripto",
    market: "Mercado",
    analysis: "An√°lisis",
    portfolioTitle: "Portafolio",
    syncedAccount: "Sincronizado con tu cuenta",
    storedLocally: "Almacenado localmente",
    totalValue: "Valor Total",
    profitLoss: "Ganancias/P√©rdidas",
    returnPercent: "Retorno",
    yourAssets: "Tus Activos",
    swipeToSeeMore: "Desliza para ver m√°s ‚Üí",
    noAssets: "¬°Sin activos a√∫n!\n¬°Comienza tu portafolio!",
    addAsset: "Agregar Activo",
    trackingOnly: "Solo seguimiento",
    value: "Valor",
    searchCoin: "Buscar Moneda",
    searchPlaceholder: "Buscar por nombre o ticker...",
    amount: "Cantidad (opcional)",
    amountPlaceholder: "Dejar vac√≠o para seguir sin cantidad",
    buyPrice: "Precio de Compra (USD) (opcional)",
    buyPricePlaceholder: "Dejar vac√≠o sin precio",
    addToPortfolio: "Agregar al Portafolio",
    marketTitle: "Mercado",
    marketSubtitle: "Datos de mercado en vivo",
    topGainers: "üî• Mayores Ganancias (24h)",
    topLosers: "üìâ Mayores P√©rdidas (24h)",
    topCoins: "üíé Top 20 por Capitalizaci√≥n",
    marketCap: "Cap",
    volume: "Vol",
    change24h: "24h",
    price: "Precio",
    rank: "#",
    lastUpdated: "Actualizado",
    pullToRefresh: "Deslizar para actualizar",
    setPriceAlert: "Establecer Alerta",
    priceAlerts: "Alertas de Precio",
    alertsNone: "Sin alertas",
    createAlert: "Crear Alerta",
    targetPrice: "Precio Objetivo",
    notifyWhen: "Notificar cuando",
    goesAbove: "Suba de",
    goesBelow: "Baje de",
    currentPrice: "Actual",
    saveAlert: "Guardar",
    deleteAlert: "Eliminar",
    alertSet: "Alerta para",
    coinAlerts: "Alertas de Moneda",
    showAll: "Mostrar Todas",
    noAlertsForCoin: "No hay alertas para esta moneda.",
    addAlert: "Agregar Alerta",
    addNewAlert: "Agregar Nueva Alerta",
    editAlert: "Editar Alerta",
    notifyWhenGoesAbove: "Notificar cuando el precio suba de",
    notifyWhenGoesBelow: "Notificar cuando el precio baje de",
    saveChanges: "Guardar Cambios",
    invalidAlert: "Alerta Inv√°lida",
    rewardsTitle: "Recompensas",
    rewardsSubtitle: "Gana puntos diarios",
    yourPoints: "Tus Puntos",
    claimDaily: "Reclamar Recompensa",
    claimed: "¬°Reclamado!",
    comeBackIn: "Vuelve en",
    hours: "horas",
    dontLoseSpuds: "¬°No pierdas tus Papas!",
    createAccountSecure:
      "Crea una cuenta para proteger tus puntos y sincronizar tu portafolio.",
    tapPotatoEarn: "Toca la papa para ganar 10 puntos",
    comeBackTomorrow: "¬°Vuelve ma√±ana por m√°s Papas!",
    howItWorks: "C√≥mo funciona",
    claim10Points: "Reclama 10 Puntos Patata cada 24 horas",
    buildStash: "Acumula tus Papas manteni√©ndote activo",
    createAccountAt20:
      "Crea una cuenta con 20 puntos para asegurar tus recompensas",
    settingsTitle: "Ajustes",
    settingsSubtitle: "Personaliza tu experiencia",
    language: "Idioma",
    account: "Cuenta",
    signIn: "Iniciar Sesi√≥n",
    signUp: "Registrarse",
    signOut: "Cerrar Sesi√≥n",
    signedInAs: "Sesi√≥n como",
    translateArticle: "Traducir Art√≠culo",
    translating: "Traduciendo...",
    showOriginal: "Ver Original (EN)",
    translationError: "Error de traducci√≥n. Int√©ntalo de nuevo.",
    article: "Art√≠culo",
    share: "Compartir",
    potatoPoints: "Puntos Patata",
  },
  fr: {
    topStory: "VEDETTE",
    livePrices: "PRIX EN DIRECT",
    allNews: "Toutes",
    cryptoNews: "Crypto",
    market: "March√©",
    analysis: "Analyse",
    swipeToSeeMore: "Glisser pour voir plus ‚Üí",
    trackingOnly: "Suivi uniquement",
  },
  de: {
    topStory: "TOP-STORY",
    livePrices: "LIVE-PREISE",
    allNews: "Alle",
    cryptoNews: "Krypto",
    market: "Markt",
    analysis: "Analyse",
    swipeToSeeMore: "Wischen f√ºr mehr ‚Üí",
    trackingOnly: "Nur Tracking",
  },
  it: {
    topStory: "TOP STORY",
    livePrices: "PREZZI LIVE",
    allNews: "Tutte",
    cryptoNews: "Crypto",
    market: "Mercato",
    analysis: "Analisi",
    swipeToSeeMore: "Scorri per vedere di pi√π ‚Üí",
    trackingOnly: "Solo tracciamento",
  },
  pt: {
    topStory: "TOP STORY",
    livePrices: "PRE√áOS AO VIVO",
    allNews: "Todas",
    cryptoNews: "Cripto",
    market: "Mercado",
    analysis: "An√°lise",
    swipeToSeeMore: "Deslize para ver mais ‚Üí",
    trackingOnly: "Apenas rastreamento",
  },
  ja: {
    topStory: "„Éà„ÉÉ„ÉóË®ò‰∫ã",
    livePrices: "„É©„Ç§„Éñ‰æ°Ê†º",
    allNews: "„Åô„Åπ„Å¶",
    cryptoNews: "‰ªÆÊÉ≥ÈÄöË≤®",
    market: "„Éû„Éº„Ç±„ÉÉ„Éà",
    analysis: "ÂàÜÊûê",
    swipeToSeeMore: "„Çπ„ÉØ„Ç§„Éó„Åó„Å¶Á∂ö„Åç„ÇíË¶ã„Çã ‚Üí",
    trackingOnly: "ËøΩË∑°„ÅÆ„Åø",
  },
  zh: {
    topStory: "Â§¥Êù°",
    livePrices: "ÂÆûÊó∂‰ª∑Ê†º",
    allNews: "ÂÖ®ÈÉ®",
    cryptoNews: "Âä†ÂØÜË¥ßÂ∏Å",
    market: "Â∏ÇÂú∫",
    analysis: "ÂàÜÊûê",
    swipeToSeeMore: "ÊªëÂä®Êü•ÁúãÊõ¥Â§ö ‚Üí",
    trackingOnly: "‰ªÖË∑üË∏™",
  },
  hi: {
    topStory: "‡§∂‡•Ä‡§∞‡•ç‡§∑ ‡§∏‡§Æ‡§æ‡§ö‡§æ‡§∞",
    livePrices: "‡§≤‡§æ‡§á‡§µ ‡§™‡•ç‡§∞‡§æ‡§á‡§∏",
    allNews: "‡§∏‡§≠‡•Ä",
    cryptoNews: "‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•ã",
    market: "‡§¨‡§æ‡§ú‡§æ‡§∞",
    analysis: "‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£",
    swipeToSeeMore: "‡§Ö‡§ß‡§ø‡§ï ‡§¶‡•á‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•ç‡§µ‡§æ‡§á‡§™ ‡§ï‡§∞‡•á‡§Ç ‚Üí",
    trackingOnly: "‡§ï‡•á‡§µ‡§≤ ‡§ü‡•ç‡§∞‡•à‡§ï‡§ø‡§Ç‡§ó",
  },
  ar: {
    topStory: "ÿßŸÑŸÇÿµÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©",
    livePrices: "ÿßŸÑÿ£ÿ≥ÿπÿßÿ± ÿßŸÑŸÖÿ®ÿßÿ¥ÿ±ÿ©",
    allNews: "ÿßŸÑŸÉŸÑ",
    cryptoNews: "ÿßŸÑÿπŸÖŸÑÿßÿ™ ÿßŸÑÿ±ŸÇŸÖŸäÿ©",
    market: "ÿßŸÑÿ≥ŸàŸÇ",
    analysis: "ÿ™ÿ≠ŸÑŸäŸÑ",
    swipeToSeeMore: "ÿßÿ≥ÿ≠ÿ® ŸÑÿ±ÿ§Ÿäÿ© ÿßŸÑŸÖÿ≤ŸäÿØ ‚Üê",
    trackingOnly: "ÿßŸÑÿ™ÿ™ÿ®ÿπ ŸÅŸÇÿ∑",
  },
};

export function getUIText(key, langCode = DEFAULT_LANGUAGE) {
  const translations =
    UI_TRANSLATIONS[langCode] || UI_TRANSLATIONS[DEFAULT_LANGUAGE];
  return translations[key] || UI_TRANSLATIONS[DEFAULT_LANGUAGE][key] || key;
}
